#!/usr/bin/env python
from pwn.crypto import RSA

# n = pq (pretty bad key)
n = 52663327194823108047941861363554667296911056447871887851271987923908183897674377410438840426978134174085827671405371681087438977062350370399673668797470776186113807376857893834326388369431932515506157599029337496768833168170979530546490477646457979867770363293437566350789835757689162734143512153253903202593

# Exponent
e = 10662335266334707061416010175090707752184800780484871995102723956866061990195856830708788718069689026583063666085399768189451747239018890190254375851709269

# Encrypted message
m1 = "This message is encrypted, lolz!"
c = RSA.encrypt(RSA.bytes2int(m1),e,n)

# Key is faulty, so we can calculate p and q
RSA.crack_rsa(n,e,c)


# This key isn't faulty :(
RSA200 = 27997833911221327870829467638722601621070446786955428537560009929326128400107609345671052955360856061822351910951365788637105954482006576775098580557613579098734950144178863178946295187237869221823983
RSA.crack_rsa(RSA200)

# Falls to Wiener's attack
crack_rsa(160523347, 60728973)
wieners_attack(27962863,25411171)
